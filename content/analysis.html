---
title: Analysis
description:
toc: true
featuredVideo:
featuredImage: https://upload.wikimedia.org/wikipedia/commons/7/77/Pebbleswithquarzite.jpg
draft: false
---


<div id="TOC">

</div>

<p>This comes from the file <code>content/analysis.Rmd</code>.</p>
<p>We describe here our detailed data analysis.</p>
<pre class="r"><code>suppressPackageStartupMessages(library(tidyverse))</code></pre>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.1.2</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 4.1.2</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.1.2</code></pre>
<pre><code>## Warning: package &#39;readr&#39; was built under R version 4.1.2</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.1.2</code></pre>
<pre class="r"><code>print(getwd())</code></pre>
<pre><code>## [1] &quot;/Users/zwy/Documents/College/Fall 2022/MA415 Data Science in R/Project/ma4615-fa22-final-project-team-swej/content&quot;</code></pre>
<pre class="r"><code>MAPvsEx &lt;- read_csv(here::here(&quot;dataset/MAPvsEx.csv&quot;))</code></pre>
<pre><code>## Rows: 10 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (3): Year, MedianMAP, GovernmentHealthExpenditure
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>modelData &lt;- read_csv(here::here(&quot;dataset/modelData.csv&quot;))</code></pre>
<pre><code>## Rows: 73280 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (6): SEQN, MAP, RIAGENDR, RIDAGEYR, RIDRETH1, Year
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code># creating multiple linear regression model to predict MAP
model &lt;- lm(MAP ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + factor(RIAGENDR), data = modelData)
summary(model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + 
##     factor(RIAGENDR), data = modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -65.642  -6.711  -0.001   6.855  77.948 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       74.547671   0.175134 425.661  &lt; 2e-16 ***
## factor(RIDRETH1)2  0.092609   0.185293   0.500  0.61722    
## factor(RIDRETH1)3 -0.133073   0.121654  -1.094  0.27402    
## factor(RIDRETH1)4  2.191404   0.133011  16.475  &lt; 2e-16 ***
## factor(RIDRETH1)5  1.337547   0.179590   7.448 9.60e-14 ***
## factor(Year)2002  -0.792644   0.194631  -4.073 4.66e-05 ***
## factor(Year)2004  -1.958727   0.198752  -9.855  &lt; 2e-16 ***
## factor(Year)2006  -2.042844   0.197630 -10.337  &lt; 2e-16 ***
## factor(Year)2008  -1.894050   0.198109  -9.561  &lt; 2e-16 ***
## factor(Year)2010  -2.935005   0.195022 -15.050  &lt; 2e-16 ***
## factor(Year)2012  -2.115927   0.201580 -10.497  &lt; 2e-16 ***
## factor(Year)2014  -2.785746   0.197615 -14.097  &lt; 2e-16 ***
## factor(Year)2016  -1.786119   0.198890  -8.980  &lt; 2e-16 ***
## factor(Year)2018  -0.668206   0.204425  -3.269  0.00108 ** 
## RIDAGEYR           0.299772   0.001994 150.358  &lt; 2e-16 ***
## factor(RIAGENDR)2 -1.935095   0.087827 -22.033  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.88 on 73264 degrees of freedom
## Multiple R-squared:  0.2498, Adjusted R-squared:  0.2497 
## F-statistic:  1627 on 15 and 73264 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>library(corrplot)</code></pre>
<pre><code>## corrplot 0.92 loaded</code></pre>
<pre class="r"><code>model_cor &lt;- cor(modelData, method = c(&quot;spearman&quot;))
corrplot(model_cor, type = &quot;upper&quot;, order = &quot;hclust&quot;, 
         tl.col = &quot;black&quot;, tl.srt = 45)</code></pre>
<p><img src="/analysis_files/figure-html/corr_matrix-1.png" width="672" /></p>
<pre class="r"><code>modelData %&gt;% ggplot(aes(x = factor(Year), y = MAP)) +
  geom_boxplot() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE) +
  labs(title = &quot;Mean Arterial Pressure (MAP) vs. Year&quot;, x = &quot;Year&quot;, y = &quot;Mean Arterial Pressure&quot;) +
  coord_flip()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/year_boxplot-1.png" width="672" /></p>
<pre class="r"><code>modelData %&gt;% ggplot(aes(x = factor(RIAGENDR), y = MAP)) +
  geom_boxplot() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE) +
  labs(title = &quot;Mean Arterial Pressure (MAP) vs. Gender&quot;, x = &quot;Gender&quot;, y = &quot;Mean Arterial Pressure&quot;) +
  coord_flip()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/gender_boxplot-1.png" width="672" /></p>
<pre class="r"><code>modelData %&gt;% ggplot(aes(x = factor(RIDRETH1), y = MAP)) +
  geom_boxplot() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE) +
  labs(title = &quot;Mean Arterial Pressure (MAP) vs. Ethnicity&quot;, 
       x = &quot;Ethnicity&quot;, y = &quot;Mean Arterial Pressure&quot;) +
  coord_flip()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/ethnicity_boxplot-1.png" width="672" /></p>
<pre class="r"><code>age_plot &lt;- ggplot(modelData, aes(x=RIDAGEYR, y=MAP)) + 
  geom_smooth(method = &quot;gam&quot;) +
  labs(title = &quot;Mean Arterial Pressure (MAP) vs. Age&quot;, 
       x = &quot;Age&quot;, y = &quot;Mean Arterial Pressure&quot;)
age_plot</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/analysis_files/figure-html/age_lineplot-1.png" width="672" /></p>
<pre class="r"><code>year_facet &lt;- age_plot + facet_wrap( ~ Year, ncol=4)
year_facet</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/analysis_files/figure-html/year_facet-1.png" width="672" /></p>
<pre class="r"><code>ethnicity_facet &lt;- age_plot + facet_wrap( ~ RIDRETH1)
ethnicity_facet</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/analysis_files/figure-html/ethnicity_facet-1.png" width="672" /></p>
<pre class="r"><code>gender_facet &lt;- age_plot + facet_wrap( ~ RIAGENDR)
gender_facet</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/analysis_files/figure-html/gender_facet-1.png" width="672" /></p>
<pre class="r"><code>plot_govExp &lt;- ggplot(data = MAPvsEx,aes(x=Year, y = GovernmentHealthExpenditure)) + 
         geom_point()
plot_medMAP &lt;- ggplot(data = MAPvsEx,aes(x=Year, y = MedianMAP)) + 
         geom_point()

library(grid)
grid.newpage()
grid.draw(rbind(ggplotGrob(plot_govExp), ggplotGrob(plot_medMAP), size = &quot;last&quot;))</code></pre>
<p><img src="/analysis_files/figure-html/MAPvsEx_sidebyside-1.png" width="672" /></p>
<pre class="r"><code>MAPEx_model &lt;- lm(MedianMAP ~ GovernmentHealthExpenditure, data = MAPvsEx)
summary(MAPEx_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MedianMAP ~ GovernmentHealthExpenditure, data = MAPvsEx)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4337 -0.7629 -0.1232  0.7889  1.5544 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  78.3139     3.1093  25.187 6.61e-09 ***
## GovernmentHealthExpenditure   0.2638     0.1607   1.642    0.139    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.05 on 8 degrees of freedom
## Multiple R-squared:  0.252,  Adjusted R-squared:  0.1585 
## F-statistic: 2.695 on 1 and 8 DF,  p-value: 0.1393</code></pre>
<pre class="r"><code>ggplot(MAPvsEx, aes(x = GovernmentHealthExpenditure, y = MedianMAP)) + 
  geom_point() +
  stat_smooth(method = &quot;lm&quot;, col = &quot;red&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/MapvsEx_reg-1.png" width="672" /></p>
<pre class="r"><code>ggplot(MAPvsEx, aes(x = Year, y = GovernmentHealthExpenditure)) + 
  geom_point() +
  stat_smooth(method = &quot;lm&quot;, col = &quot;blue&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/Ex_year_line-1.png" width="672" /></p>
<div id="note-on-attribution" class="section level2">
<h2>Note on Attribution</h2>
<p>If you are directly quoting from a source, please make that clear. You can show quotes using <code>&gt;</code> like this</p>
<pre><code>&gt; To be or not to be.</code></pre>
<blockquote>
<p>To be or not to be.</p>
</blockquote>
<p>Also, make sure to provide a link or citation to where you are quoting from.</p>
<hr />
</div>
<div id="rubric-on-this-page" class="section level2">
<h2>Rubric: On this page</h2>
<p>you will</p>
<ul>
<li>Introduce what motivates your Data Analysis (DA)
<ul>
<li>Which variables and relationships are you most interested in?</li>
<li>What questions are you interested in answering?</li>
</ul></li>
<li>Breadth of the DA
<ul>
<li>Make sure that you ask enough initial questions to explore the different variables in your data.</li>
<li>i.e. Do you explore more than just one or two variables? Do you explore a few different relationships or many?</li>
</ul></li>
<li>Depth of the DA
<ul>
<li>When you answer one question, usually more questions arise as well.</li>
<li>The depth of the DA is about coming up with and exploring the answers to these questions, often iterating the process a few times.</li>
</ul></li>
<li>Modeling and Inference
<ul>
<li>You should also include some kind of formal statistical model and/or inference. This could be a linear regression, logistic regression, hypothesis testing etc.</li>
<li>Explain the techniques you used for validating your results.</li>
<li>Describe the results of your modelling and make sure to give a sense of the uncertainty in your estimates and conclusions.</li>
</ul></li>
<li>Explain the flaws and limitations of your analysis
<ul>
<li>Are there some assumptions that you needed to make that might not hold? Is there other data that would help to answer your questions? …</li>
</ul></li>
<li>Clarity Figures
<ul>
<li>Are your figures/tables/results easy to read, informative, without problems like overplotting, hard-to-read labels, etc?</li>
<li>Each figure should provide a key insight. Too many figures or other data summaries can detract from this.</li>
</ul></li>
<li>Clarity of Explanations
<ul>
<li>Do you introduce why you are doing each analysis?</li>
<li>How well do you explain each figure/result?</li>
<li>Do you provide interpretations that suggest further analysis or explanations for observed phenomenon?</li>
</ul></li>
<li>Organization and cleanliness.
<ul>
<li>Make sure to remove excessive warnings, use clean easy-to-read code, organize with sections or multiple pages, use bullets, etc.</li>
</ul></li>
</ul>
<p><strong>NOTE</strong>: Your Data Analysis can be broken up into multiple pages if that helps with your organization.</p>
<p>Motivation:
As the United States population grows and develops, there will be a greater need for information on the general health of the nation. Our initial plan was to assess health trends over the course of time (more specifically, two decades worth of data from the National Health and Nutrition Examination Survey program). We first used diastolic and systolic blood pressures as a means of assessing general health. Later on, we ended up using Mean Arterial Pressure (MAP) instead as it provided us a way to combine both diastolic and systolic blood pressures into one value. This made the overall analysis more clean and compact. We also wanted to see how impactful ethnicity/race is on MAP; an initial exploration of the relationship between race and Thus, the variables that we are most interested in are race/ethnicity, MAP, and time (in years).
After summarizing these relationships together, we can then determine how impactful race/ethnicity is on MAP compared to other predictors of health. As a result, we generated multiple tables and plots of health variables with covariables to profile each relationship. Aside from these other predictors for health, we also plan on introducing a secondary dataset for government expenditure on general health.
Some questions we wanted to answer through our analysis:
Does government expenditure have a significant impact on general health?
How much do these other factors affect health variables?
Which of these predictors of health has the greatest impact on health?
How do health trends change over time?
Breadth of the Analysis:
Our team wanted to cast a wide net to cover as many factors and relationships as possible so that we can pinpoint significant factors. This way, we can provide evidence for our thesis to show that race/ethnicity and time greatly impact general health trends. As such, we aimed to investigate a multitude of different predictors of health in relation to MAP. We hope to better illustrate our initial exploration of time and race/ethnicity with MAP by profiling other variables.</p>
<p>Depth of the Analysis:
Since our analytics is about multiple variables in relation to MAP, there will be relationships that might have stronger impacts than other variables. Since we want to look at a wider scope of variables before pinpointing the ones that strongly influence changes in MAP trends, we might see variables with similar correlations. In this specific possibility, we can describe how two indicators of health are closely related to each other. Overall, more questions might arise after exploring different indicators of health; significant relationships might come up between independent variables as we explore them with MAP.</p>
</div>
