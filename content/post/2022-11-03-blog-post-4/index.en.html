---
title: Blog Post 4
author: Jordan Ahn, Eui Hyun Kim, Shawn Xu, Wenyan Zhang
date: '2022-11-03'
slug: []
categories: []
tags: []
description: ~
toc: yes
authors: []
series: []
lastmod: '2022-11-03T22:23:10-04:00'
featuredVideo: ~
featuredImage: ~
---


<div id="TOC">

</div>

<pre class="r"><code>#loading in modelling data
suppressPackageStartupMessages(library(tidyverse))</code></pre>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;readr&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 4.1.3</code></pre>
<pre><code>## Warning: package &#39;forcats&#39; was built under R version 4.1.3</code></pre>
<pre class="r"><code>#MAKE SURE YOU GO TO load_and_clean_data.R to get the modelData1.csv dataset. it&#39;s too big to add to git.
modelData &lt;- read_csv(here::here(&quot;dataset&quot;,&quot;modelData1.csv&quot;))</code></pre>
<pre><code>## Rows: 27862 Columns: 6
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (6): MeanDia, MeanSys, RIAGENDR, RIDAGEYR, RIDRETH1, Year
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>The purpose of this dataset is to create a snapshot of the general health of adults and children in the United States through a nationally representative sample. One trend that we noticed from our exploratory analysis was that the distributions of Blood Pressure are right-skewed. This was an interesting trend and we want to further explore its relationship to other health variables, such as blood pressure (BPQ), cholesterol (CHOL), Diabetes (DIQ), Hospital utilization and access to care (HUQ), and Demographics variables, such as Race, Age, and Sex. In other words, we will be searching for variables in the survey responses that could be easily understood and representative of general health information. These variables will be the indicators of the health status of the US population. From these variables, we can further develop statistical models to understand the variables that are most correlated with the US population’s health trends. We choose the datasets from 2001-2002, 2009-2010, and 2017-2018 because we want to investigate health trends over the past years.</p>
<p>In this data analysis, we continue to consider blood pressure to be our dependent variable because it’s representative of a person’s health. In order to analyze the correlation, we could start by plotting the regression model of it against other variables (i.e. Blood Pressure vs. Cholesterol, Blood Pressure vs. Race). This will help us define our correlating variables and confounding variables.</p>
<pre class="r"><code>#EDA
ggplot(modelData, aes(x=MeanDia, y=as.factor(Year))) + 
  geom_boxplot() + 
  labs(x = &quot;Mean Diastolic Blood Pressure&quot;, y = &quot;Year&quot;) +
  scale_y_discrete(breaks = 0:2, labels=c(&quot;2001&quot;,&quot;2009&quot;,&quot;2017&quot;))</code></pre>
<pre><code>## Warning: Removed 6109 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>ggplot(modelData, aes(x=MeanDia, y=as.factor(RIDRETH1))) + 
  geom_boxplot() + labs(x = &quot;Mean Diastolic Blood Pressure&quot;, y = &quot;Ethnicity&quot;) +
  scale_y_discrete(breaks = 1:5, labels=c(&quot;Mexican American&quot;,&quot;Other Hispanic&quot;,&quot;Non-Hispanic White&quot;,
                                          &quot;Non-Hispanic Black&quot;, &quot;Other Race&quot;)) </code></pre>
<pre><code>## Warning: Removed 6109 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<p>In the two EDA plots shown, we decided on profiling mean diastolic blood pressure. Since we wanted to look more into blood pressure and the trends associated with it, we decided on looking at mean blood pressure in relation to ethnicity and years the survey was conducted. The purpose of doing this EDA plotting is to get a glimpse of some variables that we as a team could possibly work towards or include in the final analysis. In this case, we thought about including the variables ethnicity and years to help illustrate factors that might influence blood pressure (which we deemed as an important indicator of health). From this, we could look into the significance of variables like ethnicity or years when looking at mean diastolic blood pressure as a whole to determine if these variables are conclusive and if secondary data is needed. Of course, further exploration of different variables is needed to get the whole picture.</p>
<p>The EDA plot of mean diastolic blood pressure over the years shows the distributions of 2001-2002 and 2009-2010 are similar, and the averages are similar too. However, the distribution of mean blood pressure in 2017-2018 is higher than in the other two years, suggesting that the sample population generally has higher blood pressure in 2017-2018. This could be due to diet changes in the last decade causing people to have higher blood pressure on average. The second EDA plot of mean diastolic blood pressure vs. ethnicity shows the different blood pressure distribution across races. The ethnicity with the highest mean blood pressure is Non-Hispanic Black, followed by Non-Hispanic White, other Hispanic, and Mexican American.</p>
<pre class="r"><code>#creating linear models for sysbp and diabp

#RIAGENDR: 1 = male, 2 = female
#RIDRETH1: 1 = Mexican American, 2 =  Other Hispanic, 3 = Non-Hispanic White, 4 = Non-Hispanic Black, 5 = Other Race (includes mixed)
modelData &lt;- drop_na(modelData)

syslmMulti &lt;- lm(MeanSys ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + factor(RIAGENDR), data = modelData)
summary(syslmMulti)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MeanSys ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + 
##     factor(RIAGENDR), data = modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -61.766  -9.390  -1.058   7.863 130.098 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       101.975651   0.316068 322.638  &lt; 2e-16 ***
## factor(RIDRETH1)2  -0.915262   0.443903  -2.062   0.0392 *  
## factor(RIDRETH1)3  -1.856508   0.286109  -6.489 8.84e-11 ***
## factor(RIDRETH1)4   3.241022   0.321559  10.079  &lt; 2e-16 ***
## factor(RIDRETH1)5  -0.220942   0.431451  -0.512   0.6086    
## factor(Year)1      -3.013713   0.247781 -12.163  &lt; 2e-16 ***
## factor(Year)2      -2.108333   0.271523  -7.765 8.54e-15 ***
## RIDAGEYR            0.532136   0.004714 112.874  &lt; 2e-16 ***
## factor(RIAGENDR)2  -3.371685   0.207740 -16.230  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.32 on 21744 degrees of freedom
## Multiple R-squared:  0.3813, Adjusted R-squared:  0.3811 
## F-statistic:  1675 on 8 and 21744 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>dialmMulti &lt;- lm(MeanDia ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + factor(RIAGENDR), data = modelData)
summary(dialmMulti)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MeanDia ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + 
##     factor(RIAGENDR), data = modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -75.652  -7.233   0.564   8.114  64.109 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       59.406746   0.276412 214.921  &lt; 2e-16 ***
## factor(RIDRETH1)2  1.682190   0.388209   4.333 1.48e-05 ***
## factor(RIDRETH1)3  0.966440   0.250212   3.862 0.000113 ***
## factor(RIDRETH1)4  2.961862   0.281215  10.532  &lt; 2e-16 ***
## factor(RIDRETH1)5  2.281972   0.377319   6.048 1.49e-09 ***
## factor(Year)1     -1.695659   0.216693  -7.825 5.30e-15 ***
## factor(Year)2      3.935797   0.237457  16.575  &lt; 2e-16 ***
## RIDAGEYR           0.179754   0.004123  43.598  &lt; 2e-16 ***
## factor(RIAGENDR)2 -1.392421   0.181676  -7.664 1.87e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.39 on 21744 degrees of freedom
## Multiple R-squared:  0.1211, Adjusted R-squared:  0.1207 
## F-statistic: 374.4 on 8 and 21744 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>modelData %&gt;% ggplot(aes(x = RIDAGEYR, y = MeanSys)) +
  geom_jitter() +
  stat_smooth(method = &quot;lm&quot;, se = FALSE) +
  labs(title = &quot;Simple Model of Systolic BP(mmHg) vs. Age&quot;, x = &quot;Age(Years)&quot;, y = &quot;Mean Systolic BP(mmHg)&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>modelData %&gt;% ggplot(aes(x = RIDAGEYR, y = MeanDia)) +
  geom_jitter() +
  stat_smooth(method = &quot;glm&quot;, se = FALSE) +
  labs(title = &quot;Simple Model of Diastolic BP(mmHg) vs. Age&quot;, x = &quot;Age(Years)&quot;, y = &quot;Mean Diastolic BP(mmHg)&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
