---
title: Blog Post 4
author: Jordan Ahn, Eui Hyun Kim, Shawn Xu, Wenyan Zhang
date: '2022-11-03'
slug: []
categories: []
tags: []
description: ~
toc: yes
authors: []
series: []
lastmod: '2022-11-03T22:23:10-04:00'
featuredVideo: ~
featuredImage: ~
---

```{r}
#loading in modelling data
suppressPackageStartupMessages(library(tidyverse))

#MAKE SURE YOU GO TO load_and_clean_data.R to get the modelData1.csv dataset. it's too big to add to git.
modelData <- read_csv(here::here("dataset","modelData1.csv"))
```

```{r}
#creating linear models for sysbp and diabp

#RIAGENDR: 1 = male, 2 = female
#RIDRETH1: 1 = Mexican American, 2 =  Other Hispanic, 3 = Non-Hispanic White, 4 = Non-Hispanic Black, 5 = Other Race (includes mixed)
modelData <- drop_na(modelData)

syslmMulti <- lm(MeanSys ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + factor(RIAGENDR), data = modelData)
summary(syslmMulti)

dialmMulti <- lm(MeanDia ~ factor(RIDRETH1) + factor(Year) + RIDAGEYR + factor(RIAGENDR), data = modelData)
summary(dialmMulti)

modelData %>% ggplot(aes(x = RIDAGEYR, y = MeanSys)) +
  geom_jitter() +
  stat_smooth(method = "lm", se = FALSE) +
  labs(title = "Simple Model of Systolic BP(mmHg) vs. Age", x = "Age(Years)", y = "Mean Systolic BP(mmHg)")

modelData %>% ggplot(aes(x = RIDAGEYR, y = MeanDia)) +
  geom_jitter() +
  stat_smooth(method = "lm", se = FALSE) +
  labs(title = "Simple Model of Diastolic BP(mmHg) vs. Age", x = "Age(Years)", y = "Mean Diastolic BP(mmHg)")
```
