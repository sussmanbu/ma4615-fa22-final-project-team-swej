---
title: Analysis
description:
toc: true
featuredVideo:
featuredImage: https://upload.wikimedia.org/wikipedia/commons/7/77/Pebbleswithquarzite.jpg
draft: false
---


<div id="TOC">

</div>

<p>This comes from the file <code>content/analysis.Rmd</code>.</p>
<p>We describe here our detailed data analysis.</p>
<p>##Section 1: Motivation of Data Analysis
As the United States population grows and develops, there will be a greater need for information on the general health of the nation. Our initial plan was to assess health trends over the course of time (more specifically, two decades worth of data from the National Health and Nutrition Examination Survey program). We first used diastolic and systolic blood pressures as a means of assessing general health. Later on, we ended up using Mean Arterial Pressure (MAP) instead as it provided us a way to combine both diastolic and systolic blood pressures into one value. This made the overall analysis more clean and compact. We also wanted to see how impactful ethnicity/race is on MAP; an initial exploration of the relationship between race and Thus, the variables that we are most interested in are race/ethnicity, MAP, and time (in years).</p>
<p>After summarizing these relationships together, we can then determine how impactful race/ethnicity is on MAP compared to other predictors of health. As a result, we generated multiple tables and plots of health variables with covariables to profile each relationship. Aside from these other predictors for health, we also plan on introducing a secondary dataset for government expenditure on general health.</p>
<p>Some questions we wanted to answer through our analysis:
Does government expenditure have a significant impact on general health?
How much do these other factors affect health variables?
Which of these predictors of health has the greatest impact on health?
How do health trends change over time?</p>
<p>##Section 2: Variable Analysis</p>
<p>To investigate the
<img src="/analysis_files/figure-html/year_boxplot-1.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/age_lineplot-1.png" width="672" /></p>
<pre class="r"><code># creating multiple linear regression model to predict MAP
model &lt;- lm(MAP ~ Ethnicity + factor(Year) + Age + Gender, data = train.modelData)
summary(model) </code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender, data = train.modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -64.068  -7.233  -0.550   6.720  83.671 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               79.208887   0.268027 295.526  &lt; 2e-16 ***
## EthnicityMexican American -3.386728   0.188917 -17.927  &lt; 2e-16 ***
## EthnicityOther Hispanic   -3.226913   0.247376 -13.045  &lt; 2e-16 ***
## EthnicityOther Race       -2.304722   0.239770  -9.612  &lt; 2e-16 ***
## EthnicityWhite            -3.445758   0.159370 -21.621  &lt; 2e-16 ***
## factor(Year)2002          -0.624531   0.273451  -2.284 0.022383 *  
## factor(Year)2004          -1.633870   0.278282  -5.871 4.36e-09 ***
## factor(Year)2006          -2.171135   0.276492  -7.852 4.18e-15 ***
## factor(Year)2008          -1.374975   0.271010  -5.074 3.92e-07 ***
## factor(Year)2010          -2.206979   0.269039  -8.203 2.41e-16 ***
## factor(Year)2012          -1.118101   0.276753  -4.040 5.35e-05 ***
## factor(Year)2014          -1.858980   0.272215  -6.829 8.67e-12 ***
## factor(Year)2016          -1.056082   0.273654  -3.859 0.000114 ***
## factor(Year)2018           0.628943   0.279771   2.248 0.024578 *  
## Age                        0.251894   0.003021  83.368  &lt; 2e-16 ***
## Gendermale                 2.631427   0.119711  21.981  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.03 on 40417 degrees of freedom
## Multiple R-squared:   0.17,  Adjusted R-squared:  0.1697 
## F-statistic:   552 on 15 and 40417 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre><code>##       RMSE        R2
## 1 12.10082 0.1697358</code></pre>
<pre class="r"><code># load package to perform AIC
vif(model)</code></pre>
<pre><code>##                  GVIF Df GVIF^(1/(2*Df))
## Ethnicity    1.129515  4        1.015340
## factor(Year) 1.100293  9        1.005324
## Age          1.046434  1        1.022954
## Gender       1.000783  1        1.000391</code></pre>
<pre class="r"><code># perform AIC to eliminate insignificant variables
stepAIC(model, direction =&quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=201147.4
## MAP ~ Ethnicity + factor(Year) + Age + Gender
## 
##                Df Sum of Sq     RSS    AIC
## &lt;none&gt;                      5847013 201147
## - factor(Year)  9     30254 5877268 201338
## - Gender        1     69901 5916914 201626
## - Ethnicity     4     77245 5924258 201670
## - Age           1   1005475 6852488 207561</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender, data = train.modelData)
## 
## Coefficients:
##               (Intercept)  EthnicityMexican American  
##                   79.2089                    -3.3867  
##   EthnicityOther Hispanic        EthnicityOther Race  
##                   -3.2269                    -2.3047  
##            EthnicityWhite           factor(Year)2002  
##                   -3.4458                    -0.6245  
##          factor(Year)2004           factor(Year)2006  
##                   -1.6339                    -2.1711  
##          factor(Year)2008           factor(Year)2010  
##                   -1.3750                    -2.2070  
##          factor(Year)2012           factor(Year)2014  
##                   -1.1181                    -1.8590  
##          factor(Year)2016           factor(Year)2018  
##                   -1.0561                     0.6289  
##                       Age                 Gendermale  
##                    0.2519                     2.6314</code></pre>
<pre class="r"><code># multiple linear regression model with interaction terms 
model_interaction_eth &lt;- lm(MAP ~ Ethnicity + factor(Year) + Age + Gender +  
                        Ethnicity*Age, data = train.modelData)
model_interaction_gd &lt;- lm(MAP ~ Ethnicity + factor(Year) + Age + Gender +  
                        Gender*Age, data = train.modelData)
model_interaction_both &lt;- lm(MAP ~ Ethnicity + factor(Year) + Age + Gender +  
                        Gender*Age + Ethnicity*Age, data = train.modelData)
summary(model_interaction_eth)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender + 
##     Ethnicity * Age, data = train.modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -62.514  -7.188  -0.517   6.705  85.659 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   76.499216   0.362032 211.305  &lt; 2e-16 ***
## EthnicityMexican American     -3.455946   0.440970  -7.837 4.72e-15 ***
## EthnicityOther Hispanic       -1.955161   0.622321  -3.142  0.00168 ** 
## EthnicityOther Race           -0.689151   0.586138  -1.176  0.23970    
## EthnicityWhite                 2.595090   0.385900   6.725 1.78e-11 ***
## factor(Year)2002              -0.608116   0.272004  -2.236  0.02538 *  
## factor(Year)2004              -1.646978   0.276879  -5.948 2.73e-09 ***
## factor(Year)2006              -2.122999   0.275035  -7.719 1.20e-14 ***
## factor(Year)2008              -1.458038   0.269602  -5.408 6.41e-08 ***
## factor(Year)2010              -2.308640   0.267659  -8.625  &lt; 2e-16 ***
## factor(Year)2012              -1.262471   0.275380  -4.584 4.56e-06 ***
## factor(Year)2014              -1.991905   0.270847  -7.354 1.95e-13 ***
## factor(Year)2016              -1.224773   0.272335  -4.497 6.90e-06 ***
## factor(Year)2018               0.464445   0.278446   1.668  0.09533 .  
## Age                            0.316445   0.006469  48.916  &lt; 2e-16 ***
## Gendermale                     2.662625   0.119092  22.358  &lt; 2e-16 ***
## EthnicityMexican American:Age  0.005470   0.009618   0.569  0.56955    
## EthnicityOther Hispanic:Age   -0.030557   0.012855  -2.377  0.01745 *  
## EthnicityOther Race:Age       -0.036219   0.012593  -2.876  0.00403 ** 
## EthnicityWhite:Age            -0.130808   0.007821 -16.726  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.96 on 40413 degrees of freedom
## Multiple R-squared:  0.1789, Adjusted R-squared:  0.1785 
## F-statistic: 463.5 on 19 and 40413 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(model_interaction_gd)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender + 
##     Gender * Age, data = train.modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -62.731  -7.201  -0.519   6.703  81.982 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               77.122459   0.297892 258.894  &lt; 2e-16 ***
## EthnicityMexican American -3.366833   0.188340 -17.876  &lt; 2e-16 ***
## EthnicityOther Hispanic   -3.192548   0.246624 -12.945  &lt; 2e-16 ***
## EthnicityOther Race       -2.307178   0.239032  -9.652  &lt; 2e-16 ***
## EthnicityWhite            -3.411456   0.158894 -21.470  &lt; 2e-16 ***
## factor(Year)2002          -0.631697   0.272610  -2.317   0.0205 *  
## factor(Year)2004          -1.646447   0.277426  -5.935 2.97e-09 ***
## factor(Year)2006          -2.159706   0.275642  -7.835 4.80e-15 ***
## factor(Year)2008          -1.406976   0.270184  -5.207 1.92e-07 ***
## factor(Year)2010          -2.225109   0.268214  -8.296  &lt; 2e-16 ***
## factor(Year)2012          -1.151094   0.275909  -4.172 3.03e-05 ***
## factor(Year)2014          -1.895798   0.271387  -6.986 2.88e-12 ***
## factor(Year)2016          -1.069147   0.272813  -3.919 8.91e-05 ***
## factor(Year)2018           0.625161   0.278910   2.241   0.0250 *  
## Age                        0.297942   0.004186  71.179  &lt; 2e-16 ***
## Gendermale                 6.858919   0.292309  23.465  &lt; 2e-16 ***
## Age:Gendermale            -0.093334   0.005891 -15.843  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.99 on 40416 degrees of freedom
## Multiple R-squared:  0.1752, Adjusted R-squared:  0.1748 
## F-statistic: 536.4 on 16 and 40416 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(model_interaction_both)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender + 
##     Gender * Age + Ethnicity * Age, data = train.modelData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -62.571  -7.096  -0.488   6.687  83.973 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   74.437588   0.383991 193.853  &lt; 2e-16 ***
## EthnicityMexican American     -3.424518   0.439636  -7.789 6.89e-15 ***
## EthnicityOther Hispanic       -1.761176   0.620554  -2.838  0.00454 ** 
## EthnicityOther Race           -0.719808   0.584362  -1.232  0.21804    
## EthnicityWhite                 2.601181   0.384729   6.761 1.39e-11 ***
## factor(Year)2002              -0.615010   0.271178  -2.268  0.02334 *  
## factor(Year)2004              -1.659225   0.276040  -6.011 1.86e-09 ***
## factor(Year)2006              -2.111996   0.274201  -7.702 1.37e-14 ***
## factor(Year)2008              -1.489435   0.268791  -5.541 3.02e-08 ***
## factor(Year)2010              -2.326290   0.266849  -8.718  &lt; 2e-16 ***
## factor(Year)2012              -1.293830   0.274551  -4.713 2.45e-06 ***
## factor(Year)2014              -2.027748   0.270034  -7.509 6.07e-14 ***
## factor(Year)2016              -1.235920   0.271509  -4.552 5.33e-06 ***
## factor(Year)2018               0.461630   0.277601   1.663  0.09633 .  
## Age                            0.361934   0.007068  51.207  &lt; 2e-16 ***
## Gendermale                     6.839093   0.290837  23.515  &lt; 2e-16 ***
## Age:Gendermale                -0.092206   0.005862 -15.731  &lt; 2e-16 ***
## EthnicityMexican American:Age  0.005181   0.009589   0.540  0.58899    
## EthnicityOther Hispanic:Age   -0.034122   0.012818  -2.662  0.00777 ** 
## EthnicityOther Race:Age       -0.035559   0.012555  -2.832  0.00462 ** 
## EthnicityWhite:Age            -0.130243   0.007797 -16.704  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.93 on 40412 degrees of freedom
## Multiple R-squared:  0.1839, Adjusted R-squared:  0.1835 
## F-statistic: 455.4 on 20 and 40412 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre><code>##       RMSE        R2
## 1 12.00937 0.1822237</code></pre>
<pre class="r"><code>vif(model_interaction_both)</code></pre>
<pre><code>##                      GVIF Df GVIF^(1/(2*Df))
## Ethnicity     1457.076080  4        2.485623
## factor(Year)     1.107227  9        1.005675
## Age              5.823047  1        2.413099
## Gender           6.006809  1        2.450879
## Age:Gender       7.007324  1        2.647135
## Ethnicity:Age 2467.532893  4        2.654806</code></pre>
<pre class="r"><code># perform AIC to eliminate insignificant variables
stepAIC(model_interaction_both, direction =&quot;both&quot;)</code></pre>
<pre><code>## Start:  AIC=200475.2
## MAP ~ Ethnicity + factor(Year) + Age + Gender + Gender * Age + 
##     Ethnicity * Age
## 
##                 Df Sum of Sq     RSS    AIC
## &lt;none&gt;                       5749198 200475
## - factor(Year)   9     30023 5779221 200668
## - Age:Gender     1     35204 5784402 200720
## - Ethnicity:Age  4     61727 5810925 200899</code></pre>
<pre><code>## 
## Call:
## lm(formula = MAP ~ Ethnicity + factor(Year) + Age + Gender + 
##     Gender * Age + Ethnicity * Age, data = train.modelData)
## 
## Coefficients:
##                   (Intercept)      EthnicityMexican American  
##                     74.437588                      -3.424518  
##       EthnicityOther Hispanic            EthnicityOther Race  
##                     -1.761176                      -0.719808  
##                EthnicityWhite               factor(Year)2002  
##                      2.601181                      -0.615010  
##              factor(Year)2004               factor(Year)2006  
##                     -1.659225                      -2.111996  
##              factor(Year)2008               factor(Year)2010  
##                     -1.489435                      -2.326290  
##              factor(Year)2012               factor(Year)2014  
##                     -1.293830                      -2.027748  
##              factor(Year)2016               factor(Year)2018  
##                     -1.235920                       0.461630  
##                           Age                     Gendermale  
##                      0.361934                       6.839093  
##                Age:Gendermale  EthnicityMexican American:Age  
##                     -0.092206                       0.005181  
##   EthnicityOther Hispanic:Age        EthnicityOther Race:Age  
##                     -0.034122                      -0.035559  
##            EthnicityWhite:Age  
##                     -0.130243</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/scatter_plot_gd-1.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/scatter_plot_eth-1.png" width="672" /></p>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/corr_matrix-1.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/MAPvsEx_sidebyside-1.png" width="672" /></p>
<pre><code>## 
## Call:
## lm(formula = MedianMAP ~ GovernmentHealthExpenditure, data = MAPvsEx)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.65154 -0.74958 -0.05673  0.70992  1.66061 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  82.5800     3.2779   25.19  6.6e-09 ***
## GovernmentHealthExpenditure   0.2372     0.1694    1.40    0.199    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.107 on 8 degrees of freedom
## Multiple R-squared:  0.1969, Adjusted R-squared:  0.09651 
## F-statistic: 1.961 on 1 and 8 DF,  p-value: 0.1989</code></pre>
<p><img src="/analysis_files/figure-html/MapvsEx_reg-1.png" width="672" /></p>
<p><img src="/analysis_files/figure-html/Ex_year_line-1.png" width="672" /></p>
<div id="note-on-attribution" class="section level2">
<h2>Note on Attribution</h2>
<p>If you are directly quoting from a source, please make that clear. You can show quotes using <code>&gt;</code> like this</p>
<pre><code>&gt; To be or not to be.</code></pre>
<blockquote>
<p>To be or not to be.</p>
</blockquote>
<p>Also, make sure to provide a link or citation to where you are quoting from.</p>
<hr />
</div>
<div id="rubric-on-this-page" class="section level2">
<h2>Rubric: On this page</h2>
<p>you will</p>
<ul>
<li>Introduce what motivates your Data Analysis (DA)
<ul>
<li>Which variables and relationships are you most interested in?</li>
<li>What questions are you interested in answering?</li>
</ul></li>
<li>Breadth of the DA
<ul>
<li>Make sure that you ask enough initial questions to explore the different variables in your data.</li>
<li>i.e. Do you explore more than just one or two variables? Do you explore a few different relationships or many?</li>
</ul></li>
<li>Depth of the DA
<ul>
<li>When you answer one question, usually more questions arise as well.</li>
<li>The depth of the DA is about coming up with and exploring the answers to these questions, often iterating the process a few times.</li>
</ul></li>
<li>Modeling and Inference
<ul>
<li>You should also include some kind of formal statistical model and/or inference. This could be a linear regression, logistic regression, hypothesis testing etc.</li>
<li>Explain the techniques you used for validating your results.</li>
<li>Describe the results of your modelling and make sure to give a sense of the uncertainty in your estimates and conclusions.</li>
</ul></li>
<li>Explain the flaws and limitations of your analysis
<ul>
<li>Are there some assumptions that you needed to make that might not hold? Is there other data that would help to answer your questions? …</li>
</ul></li>
<li>Clarity Figures
<ul>
<li>Are your figures/tables/results easy to read, informative, without problems like overplotting, hard-to-read labels, etc?</li>
<li>Each figure should provide a key insight. Too many figures or other data summaries can detract from this.</li>
</ul></li>
<li>Clarity of Explanations
<ul>
<li>Do you introduce why you are doing each analysis?</li>
<li>How well do you explain each figure/result?</li>
<li>Do you provide interpretations that suggest further analysis or explanations for observed phenomenon?</li>
</ul></li>
<li>Organization and cleanliness.
<ul>
<li>Make sure to remove excessive warnings, use clean easy-to-read code, organize with sections or multiple pages, use bullets, etc.</li>
</ul></li>
</ul>
<p><strong>NOTE</strong>: Your Data Analysis can be broken up into multiple pages if that helps with your organization.</p>
</div>
